<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="description" content="Rice Interactions Viewer 2.0">
        <meta name="viewport" content="width=device-width, shrink-to-fit=no, initial-scale=1">
        <title>Rice Interactions Viewer (AIV) 2.0 </title>

        <!-- Latest compiled and minified Bootstrap CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
              integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        <!-- jQuery library -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        
        <!-- Latest compiled and minified Bootstrap Javascript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
                integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

        <!-- Stylesheet for AIV 2.0 -->
        <link rel="stylesheet" href="styles/aiv.css">

        <!-- Cytoscape -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.2.15/cytoscape.min.js"></script>

        <!-- Cytoscape Canvas -->
        <script src="scripts/cytoscape-canvas.js"></script>

        <!-- qtip2 -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js" integrity="sha256-a+PRq3NbyK3G08Boio9X6+yFiHpTSIrbE7uzZvqmDac=" crossorigin="anonymous"></script>
        <script src="scripts/cytoscape-qtip.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.css"/>

        <!-- Cytoscape Context menus -->
        <link rel="stylesheet" href="styles/cytoscape-context-menus.css">
        <script src="scripts/cytoscape-context-menus.js"></script>

        <!-- Cerebral Web Cytoscape Layout -->
        <script src="scripts/cerebralJSModified.js"></script>
        <script src="scripts/modifiedCerebralJSLayout.js"></script>

        <!-- cose-bilkent layout -->
        <script src="scripts/cytoscape-cose-bilkent.js"></script>

        <!-- Select2 -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.5/js/select2.min.js" integrity="sha256-FA14tBI8v+/1BtcH9XtJpcNbComBEpdawUZA6BPXRVw=" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.5/css/select2.min.css" integrity="sha256-xJOZHfpxLR/uhh1BwYFS5fhmOAdIRQaiOul5F/b7v3s=" crossorigin="anonymous" />

        <!-- Highlight Js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css" integrity="sha256-akwTLZec/XAFvgYgVH1T5/369lhA2Efr22xzCNl1nHs=" crossorigin="anonymous"/>

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">

        <!-- Google Font -->
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">

        <!-- TableFilterJS -->
        <script src="scripts/tablefilter/tablefilter.js"></script>

        <!--TableCSVExportjs-->
        <script src="scripts/jquery.TableCSVExport.js"></script>

        <!-- Lodash -->
        <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/memoize.min.js"></script>

        <!-- ClipboardJs -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script>

        <!-- To simplify coding TODO: Remove this during launch -->
        <!--<script src="https://cdn.rawgit.com/Q42/LiveJS/bf827065/livejs.js"></script>-->
        <!--<script src="./scripts/automateInput.js"></script>-->

    </head>

    <body>
        <nav class="navbar navbar-default">
            <div class="flex-container-main">
                <a class="logo" href="//bar.utoronto.ca" target="_blank">
                    <img src="//bar.utoronto.ca/BAR/images/BAR.png">
                </a>

                <div class="flex-container-title">
                    <h5 class="subheader">Query AIV</h5>
                    <div class="flex-container-export">
                        <span id="showFormModal">
                            <i class="far fa-play-circle fa-2x"></i>
                        </span>
                        <span id="showLegendModal" class="center-icon">
                            <i class="far fa-question-circle fa-2x"></i>
                        </span>
                        <span id="showUploadModal">
                            <i class="fa fa-upload fa-2x"></i>
                        </span>
                    </div>
                    <h5 class="subheader">Export</h5>
                    <div class="flex-container-export">
                        <span id="showCSVModal">
                            <i class="fas fa-table fa-2x"></i>
                        </span>
                        <span id="showPNGModal" class="center-icon">
                            <i class="fas fa-image fa-2x"></i>
                        </span>
                            <span id="showJSONModal">
                            <i class="fas fa-download fa-2x"></i>
                        </span>
                    </div>
                </div>

                <div class="flex-container-layout-buttons">
                    <h5 class="subheader"> Layouts </h5>
                    <div class="flex-layout-buttons">
                        <button class="button-layout" id="spreadLayout"></button>

                        <button class="button-layout" id="localizationLayout"></button>

                        <button class="button-layout" id="coseCompoundLayout"></button>
                    </div>
                </div>

                <div class="flex-container-zoom-pan-buttons">
                    <div class="flex-container-zoom-buttons">
                        <button class="button-zoom" id="zoomIn">
                            <i class="fas fa-search-plus fa-2x"></i>
                        </button>

                        <button class="button-zoom" id="zoomOut">
                            <i class="fas fa-search-minus fa-2x"></i>
                        </button>
                    </div>

                    <div class="flex-container-pan-buttons">
                        <button class="button-pan" id="panUp">
                            <i class="fas fa-caret-up fa-2x"></i>
                        </button>

                        <button class="button-pan" id="panLeft">
                            <i class="fas fa-caret-left fa-2x"></i>
                        </button>

                        <button class="button-pan" id="zoomReset">
                            <i class="fas fa-expand-arrows-alt fa-lg"></i>
                        </button>

                        <button class="button-pan" id="panRight">
                            <i class="fas fa-caret-right fa-2x"></i>
                        </button>

                        <button class="button-pan" id="panDown">
                            <i class="fas fa-caret-down fa-2x"></i>
                        </button>
                    </div>

                </div>

                <div class="filter-column" id="eyeColumn">
                    <div id="filterNonQueryEyeDiv">
                        <i id="filterNonQueryEye" class="far fa-eye"></i> Non-Query Genes
                    </div>
                    <div id="hideDonutDiv" class="label-checkbox">
                        <i id="hideDonutEye" class="far fa-eye"></i> Localization Data
                    </div>
                    <div id="exprPredLocDiv" class="label-checkbox">
                        <i id="exprPredLocEye" class="far fa-eye"></i> Pred Localizations
                    </div>
                </div>

                <div class="filter-column filter-grid">
                    <div class="finder">
                        <label for="highlightNodesRGIs">Find RGIs</label>
                        <input id="highlightNodesRGIs" type="text" placeholder=' Highlight delimited RGIs by "," eg "LOC_Os02g52140, LOC_Os03g54160"'>
                        <label for="highlightNodes" id="highlightNodes">
                            <i class="fas fa-filter"></i>
                        </label>
                        <span id="cancelHighlight">
                            <i class="fas fa-times"></i>
                        </span>
                    </div>
                    <div class="eppi-filter">
                        <section class="slider-checkbox">
                            <input id="filterEPPIsCheckbox" type="checkbox" class="submit-reset">
                            <label class="label-checkbox" for="filterEPPIsCheckbox">
                                Show Experimental PPIs with:
                            </label>
                        </section>
                        <label for="EPPICorrThreshold" class="threshold-label">
                            Correlation Coefficient greater than
                        </label>
                        <input id="EPPICorrThreshold" class="threshold" type="number" min="-1.0" max="1.0" step="0.1" value ="-1.0" maxlength="2" disabled/>
                        <div id="multi-select">
                            <div id="pseudo-select-box">
                                <select id="pseudo-select" class="not-allowed">
                                    <option>Filter Specific Publication(s)</option>
                                </select>
                                <div id="overSelect" class="not-allowed"></div>
                            </div>
                            <div id="refCheckboxes">
                                <!-- The checkboxes will be added dynamically here -->
                            </div>
                        </div>
                    </div>
                    <div class="pppi-filter flex-container-PPPI-filter filter-column">
                        <section class="slider-checkbox">
                            <input id="filterPPPIsCheckbox" type="checkbox" class="submit-reset">
                            <label class="label-checkbox" for="filterPPPIsCheckbox">
                                Show Predicted PPIs with:
                            </label>
                        </section>
                        <div>
                            <label for="PPPICorrThreshold">
                                Correlation Coefficient greater than
                            </label>
                            <input id="PPPICorrThreshold" class="threshold" type="number" min="-1.0" max="1.0" step="0.1" value ="-1.0" maxlength="2" disabled/>
                        </div>
                    </div>
                </div>


                <div class="flex-container-dropdowns">
                    <p>Expression Source</p>
                    <select id="dropdownSource" disabled>
                        <option>Select Source</option>
                    </select>
                    <p>Expression Tissue</p>
                    <select id="dropdownTissues" class="not-allowed" disabled>
                        <option>Select Tissues</option>
                    </select>
                </div>

                <div class="flex-container-dropdowns">
                    <section id="exprnOverlayChkAndLabel" class="slider-checkbox not-allowed" title="Select a source & tissue first!">
                        <input id="exprnOverlayChkbox" type="checkbox" class="submit-reset" disabled>
                        <label class="label-checkbox" for="exprnOverlayChkbox">
                            Overlay Expression
                        </label>
                    </section>
                    <form>
                        <input name="expression_mode" value="absolute" id="absExpression" type="radio" checked> <!-- Absolute as default -->
                        <label for="absExpression">
                            Absolute
                        </label>
                        <input name="expression_mode" value="relative" id="relExpression" type="radio">
                        <label for="relExpression">
                            Relative
                        </label>
                    </form>
                    <div class="flex-container-export">
                        <section class="slider-checkbox">
                            <input id="exprLimitChkbox" type="checkbox" class="not-allowed submit-reset">
                            <label class="label-checkbox" for="exprLimitChkbox">
                                Limit Expression
                            </label>
                        </section>
                    </div>
                    <input id="exprThreshold" type="number" min="1" placeholder="Limit expression val">
                </div>
            </div>
        </nav>
        <main>

            <!-- Page content -->
            <div>
                <div id="cy">
                    <canvas id="exprGradientCanvas" width="70" height="300"></canvas>
                </div>
                <div id="loading">
                </div>
            </div> <!-- Page content -->

        </main> <!-- wrapper -->

        <!-- Modals -->

        <!-- Form -->
        <div id="formModal" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>Rice Interactions Viewer 2.0</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fas fa-window-close"></i></button>
                        </div>
                        <br>
                        <h6>Visualize predicted & experimentally validated protein-protein/DNA interactions</h6>
                        <br>
                        <label class="collapse" for="aboutUs">Click to learn more</label>
                        <input id="aboutUs" type="checkbox">
                        <div class="information">
                            <p>The Arabidopsis Interactions Viewer queries a database of 70,944 predicted and 91,175 confirmed Arabidopsis interacting proteins. We have also included 2.8 million experimentally determined protein-DNA interactions. </p>
                            <p>The predicted interactions (interologs) were generated by Drs Matt Geisler and Jane Geisler-Lee at the Southern Illinois University (Geisler-Lee et al., 2007). Their current version is Interactome 2.0. The confirmed Arabidopsis interacting proteins come from BioGRID (Chatr-aryamontri et al. 2017), BIND - the Biomolecular Interaction Network Database, from high-density Arabidopsis protein microarrays (Popescu et al.,
                            2007; Popescu et al., 2009), from Braun et al.'s Arabidopsis Interactome 2011 , from Wolf Frommer's Membrane protein
                                INteractome Database MIND, and over 1,190 other literature sources.</p>
                            <p> The protein-protein interactions in these sources were identified using several different methods, such as yeast two hybrid screens, but also via traditional biochemical methods. Use the links in the reference column that are in the tabular output of this viewer to view further information, or mouse-over the edges. </p>
                            <p> The DNA-protein data were generously provided by O'Malley et al. (2016), Gaudinier et al. (2011), Taylor-Teeples et al. (2015), Li et al. (2014), and Brady et al. (2011) and were mostly generated by DAP-seq, with some generated by Y1H. </p>
                            <p> All subcellular localisation data is from SUBA, the Arabidopsis Subcellular Database (Hooper et al., 2017). Additional protein function data is from MapMan (Usadel et al., 2009).</p>
                            <p> Designed and Developed by Vincent Lau with design consultation from Dr. Nicholas Provart. Built with CytoscapeJS, thanks to Max Franz and Asher Pasha for development advice. Funding provided by Genome Canada and NSERC. </p>
                            <p> <a href="https://github.com/VinLau/AIV-v2-cytoscapeJS" target="_blank">Github Repo</a> </p>
                        </div>
                    </div>
                    <div class="modal-body">
                        <form id="input_form">
                            <div class="form-group">
                                <label for="genes">Enter a list of genes seperated by newlines:</label>
                                <textarea class="form-control gene-form" id="genes" rows="15" placeholder="LOC_Os01g01700"></textarea>
                                <br>
                                <p>Or select from a list of effectors</p>
                                <select id="effectorSelect">
                                    <option id="loadingEffectors" value="none">Loading effectors...</option>
                                </select>
                                <span id="addEffectorButton">
                                    <i class="fas fa-plus-circle"></i>
                                </span>
                                <br>
                                <br>
                                <p>Select options:</p>

                                <div class="checkbox">
                                    <label><input id="published" type="checkbox" class="form-chkbox" value="">Show only interactions from published data sets</label>
                                </div>
                                <div class="checkbox">
                                    <label><input id="circleLyChkbox" type="checkbox" class="form-chkbox" value="">Use circular layout for for larger networks </label>
                                    <i id="aboutCircle" class="fas fa-info-circle" title="Larger networks require much more processing time for force-directed (spread) layouts, check for a Circos-like layout"></i>
                                </div>

                                <p>Select databases to query:</p>

                                <div class="checkbox">
                                    <label class="not-allowed"><input id="queryBioGrid" type="checkbox" value="" class="form-chkbox form-chk-needed" disabled><span id="BioGridSpan">Query interactions from BioGrid</span></label>
                                    <i class="fas fa-exclamation-circle aboutPSICQUIC" title="PSICQUIC services such as BioGrid are slower to request; not suggested for larger networks"></i>
                                    <i id="spinnerBioGrid" class="fa fa-cog fa-spin" aria-hidden="true"></i>
                                </div>

                                <div class="checkbox">
                                    <label class="not-allowed"><input id="queryIntAct" type="checkbox" class="form-chkbox form-chk-needed" value="" disabled><span id="IntActSpan">Query interactions from IntAct</span></label>
                                    <i class="fas fa-exclamation-circle aboutPSICQUIC" title="PSICQUIC services such as IntAct are slower to request; not suggested for larger networks"></i>
                                    <i id="spinnerIntAct" class="fa fa-cog fa-spin" aria-hidden="true"></i>
                                </div>

                                <div class="checkbox">
                                    <label><input id="queryBAR" type="checkbox" class="form-chkbox form-chk-needed" value="" checked>Query protein-protein interactions from BAR</label>
                                </div>

                                <div class="checkbox">
                                    <label class="" ><input id="recursive" type="checkbox" class="form-chkbox" value="">Search for interactions between interactors</label>
                                </div>

                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <div class="pull-left">
                            <input type="submit" id="submit" class="form-button" value="Submit">
                            <input type="reset" id="resetForm" class="form-button" value="Reset">
                            <button type="button" class="form-button" id="example">Example</button>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- Form -->

        <!-- Upload -->
        <div id="uploadModal" class="modal fade centered-modal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>Upload Cytoscape JSON</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fas fa-window-close"></i></button>
                        </div>
                        <hr>
                        <p>
                            Upload an exported AIV2 cytoscape JSON or your own protein-protein interaction data. For uploading your own data, see the below JSON structure and use the same property names. Also preappend nodes with 'Protein_' in 'id'. The app will then overlay your network with extras such as localization data. Some features are disabled when uploading such as the table view and DNA tooltips.
                        </p>
                    </div>
                    <pre>
                        <code id="sampleJSON">
{
  "elements" : {
    "nodes" : [
    {
      "data" :
        {
          "id" : "Protein_At1g25420",
          "name" : "At1g25420"
        }
    },
    {
      "data" :
        {
          "id" : "Protein_At5g49650",
          "name" : "At5g49650"
        }
    },
    {
      "data" :
        {
          "id" : "Effector_HARXLL429",
          "name" : "HARXLL429"
        }
    }
    ],
    "edges" : [
    {
      "data" :
        {
          "id" : "Protein_At5g49650_Protein_At1g25420",
          "source" : "Protein_At1g25420",
          "target" : "Protein_At5g49650"
        }
    },
    {
      "data" :
        {
          "id" : "Effector_HARXLL429_Protein_At5g49650",
          "source" : "Protein_At5g49650",
          "target" : "Effector_HARXLL429"
        }
    }
    ]
  }
}
                        </code>
                    </pre>
                    <div class="modal-body">
                        <input type="file" id="uploadJSON" accept="application/json">
                    </div>
                </div>
            </div>
        </div> <!-- Upload -->

        <!-- Legend -->
        <div id="LegendModal" class="modal fade centered-modal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>Legend</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fas fa-window-close"></i></button>
                        </div>
                    </div>
                    <div class="modal-body">
                        <img src="images/AIV2-legend-01.jpg" alt="Legend">
                    </div>
                </div>
            </div>
        </div> <!-- Legend -->

        <!-- PNG Export -->
        <div id="PNGModal" class="modal fade centered-modal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>PNG Export</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fas fa-window-close"></i></button>
                        </div>
                    </div>
                    <div class="modal-body">
                        <img id="png-export" src="" alt="PNG export">
                    </div>
                </div>
            </div>
        </div>

        <!-- JSON Export -->
        <div id="JSONModal" class="modal fade centered-modal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>JSON Export</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fas fa-window-close"></i></button>
                        </div>
                    </div>
                    <div class="modal-body ">
                        <pre>
                            <code id="json-export" class="json">
                                Cytoscape app not yet loaded
                            </code>
                        </pre>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="copy-to-clipboard" class="btn btn-default" title="Not supported in some browsers" data-clipboard-target="#json-export">
                            Copy to Clipboard
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- CSV Export -->
        <div id="CSVModal" class="modal fade centered-modal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>CSV Export</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fas fa-window-close"></i></button>
                        </div>
                    </div>
                    <div class="modal-body ">
                        <table id="csvTable">
                            <thead>
                                <tr>
                                    <th class="small-csv-column">Interaction Type </th>
                                    <th class="small-csv-column">Gene 1 (Source)</th>
                                    <th class="small-csv-column">Gene 2 (Target)</th>
                                    <th class="small-csv-column">Gene 1 Annotation</th>
                                    <th class="small-csv-column">Gene 2 Annotation</th>
                                    <th class="small-csv-column">
                                        Interolog Confidence/S-PPI rank
                                        <i id="about-sppi" class="fas fa-question-circle" title="For Protein-Protein interactions:Interlog confidence values are positive, the higher; the better. Conversely, S-PPI rankings are negative, the closer to 0, the better the ranking. For Protein-DNA interactions: Value represents the p-value calculated from the FIMO algorithm (predicts PDIs)"></i>
                                    </th>
                                    <th class="small-csv-column">Pearson Correlation</th>
                                    <th class="med-csv-column">Reference</th>
                                    <th class="med-csv-column">MI Term</th>
                                    <th class="lg-csv-column">Gene 1 Localization</th>
                                    <th class="lg-csv-column">Gene 2 Localization</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="exportCSV" class="btn btn-default" title="Please disable <br/> popup blockers!">
                            Download CSV
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- incomplete form alert -->
        <div id="formErrorModal" class="modal fade centered-modal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4 class="form-modal-msg">Incomplete Form Warning</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fas fa-window-close"></i></button>
                        </div>
                    </div>
                    <div class="modal-body">
                        <h4 id="errorModalBodyMsg" class="form-modal-msg"></h4>
                    </div>
                </div>
            </div>
        </div>

    </body>
    <!--alertify.js-->
    <script src="scripts/alertify.js"></script>
    <!-- AIV 2.0 JS -->
    <script src="scripts/aiv.js"></script>
    <!-- AIV 2.0 UI Options JS -->
    <script src="scripts/aiv_ui.js"></script>
</html>

